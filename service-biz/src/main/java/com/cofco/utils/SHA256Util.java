package com.cofco.utils;

import com.cofco.sys.entity.members.MembersEntity;
import com.cofco.sys.service.members.MembersService;
import org.apache.commons.codec.binary.Base64;
import org.apache.commons.codec.digest.DigestUtils;
import org.apache.log4j.Logger;
import org.springframework.beans.factory.annotation.Autowired;

import java.security.*;
import java.security.interfaces.RSAPrivateKey;
import java.security.interfaces.RSAPublicKey;
import java.security.spec.PKCS8EncodedKeySpec;
import java.security.spec.X509EncodedKeySpec;
import java.util.*;

/**
 * 数字签名业务管理
 * @author handi
 * @date 2019 11/06 13:52:11
 * @email 876053009@qq.com
 */
public  class SHA256Util {
    @Autowired
    private MembersService membersService;

    public static final String SIGNATURE_ALGORITHM = "SHA256withRSA";

    public static final String ENCODE_ALGORITHM = "SHA-256";

    /**加密算法RSA*/
    public static final String KEY_ALGORITHM = "RSA";

    /** 填充方式*/
//    public static final String KEY_ALGORITHM_PADDING = "RSA/ECB/PKCS1Padding";

    /**密钥位数 1024 2048*/
    public static final int RAS_KEY_SIZE = 2048;
    static Logger log = Logger.getLogger(SHA256Util.class);

    /**生成没有加过密的公私钥*/
    public static Map<String, Object> createKey(String algorithm,int keysize) throws Exception {
        KeyPairGenerator keyPairGen = KeyPairGenerator.getInstance(algorithm);
        keyPairGen.initialize(keysize);
        KeyPair keyPair = keyPairGen.generateKeyPair();

        //通过对象 KeyPair 获取RSA公私钥对象RSAPublicKey RSAPrivateKey
        RSAPublicKey publicKey = (RSAPublicKey) keyPair.getPublic();
        RSAPrivateKey privateKey = (RSAPrivateKey) keyPair.getPrivate();

        //公私钥对象存入map中
        Map<String, Object> keyMap = new HashMap<String, Object>(2);
        keyMap.put("publicKey", publicKey);
        keyMap.put("privateKey", privateKey);
        return keyMap;
    }

    /**
     * 生成签名
     * @param privateKey  私钥
     * @param plainText 明文
     * @return
     */
    public static byte[] sign(PrivateKey privateKey, String plainText) {
        MessageDigest messageDigest;
        byte[] signed = null;
        try {
            messageDigest = MessageDigest.getInstance(ENCODE_ALGORITHM);
            messageDigest.update(plainText.getBytes());
            byte[] outputDigest_sign = messageDigest.digest();
            Signature Sign = Signature.getInstance(SIGNATURE_ALGORITHM);
            Sign.initSign(privateKey);
            Sign.update(outputDigest_sign);
            signed = Sign.sign();
        } catch (NoSuchAlgorithmException | InvalidKeyException | SignatureException e) {
            e.printStackTrace();
        }
        return signed;
    }

    /**
     * 验证签名
     * @param publicKey 公钥
     * @param plain_text 明文
     * @param signed 签名
     */
    public static boolean verifySign(PublicKey publicKey, String plain_text, byte[] signed) {
        MessageDigest messageDigest;
        boolean SignedSuccess=false;
        try {
            messageDigest = MessageDigest.getInstance(ENCODE_ALGORITHM);
            messageDigest.update(plain_text.getBytes());
            byte[] outputDigest_verify = messageDigest.digest();
            //System.out.println("SHA-256加密后-----》" +bytesToHexString(outputDigest_verify));
            Signature verifySign = Signature.getInstance(SIGNATURE_ALGORITHM);
            verifySign.initVerify(publicKey);
            verifySign.update(outputDigest_verify);
            SignedSuccess = verifySign.verify(signed);
            System.out.println("验证成功？---" + SignedSuccess);

        } catch (NoSuchAlgorithmException | InvalidKeyException | SignatureException e) {
            e.printStackTrace();
        }
        return SignedSuccess;
    }


    /**
     * bytes[]换成16进制字符串
     *
     * @param src
     * @return
     */
    public static String bytesToHexString(byte[] src) {
        StringBuilder stringBuilder = new StringBuilder("");
        if (src == null || src.length <= 0) {
            return null;
        }
        for (int i = 0; i < src.length; i++) {
            int v = src[i] & 0xFF;
            String hv = Integer.toHexString(v);
            if (hv.length() < 2) {
                stringBuilder.append(0);
            }
            stringBuilder.append(hv);
        }
        return stringBuilder.toString();
    }

    /**
     * 将16进制字符串转换为byte数组
     *
     * @param
     */
    public static byte[] hexStringToBytes(String hexString) {
        if (hexString == null || hexString.equals("")) {
            return null;
        }

        hexString = hexString.trim().replaceAll("\\s*", "");

        String hexFormat = "0123456789ABCDEF";

        hexString = hexString.toUpperCase();
        int length = hexString.length() / 2;
        char[] hexChars = hexString.toCharArray();
        byte[] d = new byte[length];
        for (int i = 0; i < length; i++) {
            int pos = i * 2;
            d[i] = (byte) (hexFormat.indexOf(hexChars[pos]) << 4 | hexFormat
                    .indexOf(hexChars[pos + 1]));
        }
        return d;
    }

    /**
     * 将公钥转为字符串
     */
    public static String pubToStr(PublicKey publicKey){
        String publicKeyString = new String(Base64.encodeBase64(publicKey.getEncoded()));
        return publicKeyString;
    }

    /**
     * 将私钥转为字符串
     */
    public static String priToStr(PrivateKey privateKey){
        String privateKeyString = new String(Base64.encodeBase64((privateKey.getEncoded())));
        return privateKeyString;
    }

    /**
     * 将公钥串转换为公钥
     */
    public static PublicKey strToPub(String publicKeyString) {
        try {
            byte[] decoded = Base64.decodeBase64(publicKeyString);
            RSAPublicKey publicKey = (RSAPublicKey) KeyFactory.getInstance("RSA").generatePublic(new X509EncodedKeySpec(decoded));
            return  publicKey;
        }catch (Exception e){
            e.printStackTrace();
        }
        return  null;
    }

    /**
     * 将私钥串转换为私钥
     */
    public static PrivateKey strToPri(String privateKeyString) {
        try {
            byte[] decoded = Base64.decodeBase64(privateKeyString);
            RSAPrivateKey privateKey = (RSAPrivateKey) KeyFactory.getInstance("RSA").generatePrivate(new PKCS8EncodedKeySpec(decoded));
            return  privateKey;
        }catch (Exception e){
            e.printStackTrace();
        }
        return  null;
    }

    /**
     * 字符串转换成二进制流
     *
     * @param str 字符串
     * @return 二进制流
     */
    public static String strToBinary(String str) {
         String[] PREFIX_POOL = {"0", "00", "000", "0000", "00000", "000000", "0000000", "00000000",
                "000000000", "0000000000", "00000000000", "000000000000",
                "0000000000000", "00000000000000", "000000000000000"
        };

        if (null == str || str.trim().length() == 0) {
            return null;
        }

        char[] strChar = str.toCharArray();
        StringBuilder result = new StringBuilder(strChar.length << 4);
        for (int i = 0; i < strChar.length; i++) {
            // 二进制ASCII码
            String s = Integer.toBinaryString(strChar[i]);
            // 补0
            if (s.length() < 16) {
                s = PREFIX_POOL[15 - s.length()].concat(s);
            }

            result.append(s);
        }
        return result.toString();
    }

    /**
     * 二进制流转换成字符串
     *
     * @param binaryString 二进制流
     * @return 字符串
     */
    public static String binaryToString(String binaryString) {
        if (null == binaryString || binaryString.trim().length() == 0) {
            return null;
        }

        int len = binaryString.length();
        StringBuilder sb = new StringBuilder(len >> 4);
        int step = 16;
        for (int i = 0; i < len; i += step) {
            // 将ascll码强转成字符
            sb.append((char) (int) Integer.parseInt(binaryString.substring(i, i + step), 2));
        }

        return sb.toString();
    }

    //得到32位的uuid
    public static String getUUID32(){
        return UUID.randomUUID().toString().replace("-", "").toLowerCase();
    }

    public static String createSign(SortedMap<String, String> map){
        //数字签名
        try{
            log.info("map值：" + map);
            //按照参数名ASCII码从小到大排序拼接成字符串stringA。
            String stringA= SignatureUtil.genOrderedString(map);
            //对stringA使用SHA256算法运算作为数字摘要stringDigest
            String stringDigestA = DigestUtils.sha256Hex(stringA);
            log.info("签名前的stringDigestA数字摘要值：" + stringDigestA);
            //wh00324下的公私钥
            //String pr = "MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQDFlPly1Q4XPmp0VK9DlD3PFtiZ+pfV05c2juZ6JzpxPShPOezm46V5wWAjGKRZxpzzbcDBrDravqkc47lVXxcVMS7UIrotha9kDGb9YB1YnLGwknM9kcGZ7dmRVTaV5dEumvJvOBVebFxgKorwreEDC1bRiakkOhcV7LjE7GiOEpvZc9t6GzLQoTMt3KZ8MScW2xbbdrI2mom/2RyvQgkN+dOBeMCL/YSkj9hWABYcbZMt+IPz4VfK3jfWMAwwVNe7lQjGv/3UBMcQKL4p146vOe85Rj8KwTjXcMazgaIH8h0vqWFmUbllfCQC+zh+KcoQju/UISvQRpACYtPE7sKTAgMBAAECggEAcDuGUsdZQLTQrZHpGJ8dWQQmN5kUJH8TlwcnPl4IIYjW2+IQgrrvJTFGFcmKmgBq6Q///UODDvxcfa+ReEASkZQlgJTVYsRcc51j5ytwoAQqHx2hXmjsKy7jdl2MKyunXizf53NZGBC/jFS+JabveNY5E795l71znZ2g+yM65PAHTR4dwKWEkM1ZELxMV2McybjacrFC2lZXl+M0sjLkFhjipg1uAkvmzVbqCsitvUAsNHZCSllhldPuMEB3kKQn145nKxETQaj363yK3OIvGUbAFB5eIXDDLfSsKl/E3hxjNpZOiZwj+7QCYm7tNfmhvxTyCjEd67CffsO2OiAv6QKBgQDsMkgl6GGbfLQRVsE4P2Hg1dsDbMIhJaZ9ZIZNXAVKOkLS78OQIIdlrBewng6kmiLfypSAlIVt9DJ7GQmMaRFLOTi1sGH1EFmJvKAQwzp4TtEQ+I0wHw17nId3Fv7DHKdIQnC2w9/M8onZNfSl/Szsg5EMIscmcgcpvnsIY8WwpwKBgQDWJd8hgg0Q99VvloZ5Jy+kyhjkkhaOaiEgLkaA3aJhqwTAlOXlhvZJ7YfKSxml5Xf10ekIDSZmMGNTP6OBbZRY3C7LrmyDsAxM9DgguHzV7n2j7OD0kgX+jdpFT0k28SuPn4ZFAsUC1XZoRYD7Apu6BwyHdg1ypAWngIsDgGtQNQKBgQDS3vlGzrcF6EmjCT8sBnpODt+fqSOQEFsZq/uzaSpX4Lf0Npb0P/ZhsUjdJ9+O2QW1otj+CpstVU0UVYAO2WbVL9sPas+pyNUHgV2uWX4EFunUKvNyOOcCqvbOPbtpWlWGz7ptkWZnRUoIoIExCF1pMvT2Tr5Z9oeqnyKclObUFQKBgEa/9FwJr29vseBQBtV4ENGMw3Sgnzsl7RPIthpVHxTNf6BwkROn5y69fyNidHLOwTdBxo+WaJ1SVz5lxAs6vMwu0ncQhWFshGPYO8LzsKqtRG0oEZo7tCdJjldfvnycaRvmRGIAbD5nb9s7O0Wysuhe89C9O+woLIYOfd8GSm4RAoGBAM+7JL3fkKdefkKgL6TwRwvgDyERTJICE0YGwEjDihAt4dwauKm2TazQN9Atn2scUJG18NdrXda4iREGEQyKwbmcjcucau8CefKDTgtNGH3Ko7XoZSHRxdOD7dilP+wY5e58VXZ8AG3H/0dFoIkqswy+0gBW88bfXSo2FgoqBrqi";
            //String pb =  "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxZT5ctUOFz5qdFSvQ5Q9zxbYmfqX1dOXNo7meic6cT0oTzns5uOlecFgIxikWcac823Awaw62r6pHOO5VV8XFTEu1CK6LYWvZAxm/WAdWJyxsJJzPZHBme3ZkVU2leXRLprybzgVXmxcYCqK8K3hAwtW0YmpJDoXFey4xOxojhKb2XPbehsy0KEzLdymfDEnFtsW23ayNpqJv9kcr0IJDfnTgXjAi/2EpI/YVgAWHG2TLfiD8+FXyt431jAMMFTXu5UIxr/91ATHECi+KdeOrznvOUY/CsE413DGs4GiB/IdL6lhZlG5ZXwkAvs4finKEI7v1CEr0EaQAmLTxO7CkwIDAQAB";
            //wh00379下的公私钥
            //String pr="MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCNAw+PaevvCz4Rd0WWYr99qwLksuwjHiFQbZDWGMVC1NIjVUpUuK4NK3v0WpNEaZVxcgSNGpb6ZlR/ri5+udz3gS6dU1THQ8Bzs1N8Eap+5ex+GjRvQNm3MCcvh4/oBcu3pRtJM8nfm/ZWWQY4AMOG4anOgx04mMCj1YPm8+ojc/IuPA56nkJKIbi1PTWlM6NxtRpAcF0vaMjJKKCwaQzCXSLegIdkuEmL4BfjyBOnSMvdt55wnqv4W2OydLOYzrGGE9kclfZGewteFt2Q0OR+LDQDROm1dO7t2cfmrSNHeTrqEwzsC42eMV1DgQGteV2cDivBE9GePYZyQbqgzs99AgMBAAECggEADLFI1kTXesXNSW8t8VJkICCjewhr3uFYaE/kaJEEOHbFj26e6S9SY1cVqjH47YB/dh2oMTdCfbl2Q6PfBYMfU5vqITkd+W2sxf1PN2yzpwZ1GgirzZPNxQJtlIakOmNDKf2PjjA+LIVyT+VlfOb8sohfa3o7yBtfw591ZvVvjs8/aAazGNWCKdISWVoU3kpe2Gl3+8t32rCbfnce7E9TwsF+kYYtGvWfzRZvtaHofTrzl5YJ0iUVR6kZa2hk0HICX6brWSxHlIxULxCfBly/RX+ZNjhpVBDiJ0/VBdYndE5EVxJTO7kpGW8amN1aF7tmpvrvyBoceiyR07teNE0D9QKBgQDZ2lxob0yFvuc5NSTkFQKv4ixZxSAnFG74u5bpioTzySVaga6ZO8gEs9IbnKQjc3+Qu1A8O6s4yFtAaiQJM01vgkiq5kfjf6pEesjz/KLIxJfdLp7RpaZeWWQTGxBQDHLZdrdbCtZtLLWzf1fg2dVHkFgxHsr4wvtuc7lzINgmKwKBgQCltCrZwCELgzCYm+TXCW6+PCeRg7Z4aM9y9n+lNM8L/oBUJORj4/3+KZZvXT8DSoHOkx9TnhApE4P5mWOe3B35FC9idVV2KeUvaiXaWN21jqpPjDw5dPTf/QEVXlSvtjK/ekXaUuQcpFXzG95bUo5qC9DD86ivtBykU+LaHCP09wKBgQCmfstXCZDbOs5um14pbqFSGLI6nXx4QZaaRIwOys3Xn2gL5saw186DQYcXkTyk13WsAGxOzG+MgxuyfCw0V+Abk9/DtSFGDmDr20dPqUoj1JQX97Rrl4Ux4HGqZGmwNANmjeOOEhdU8vGfUHiyIOluuzObvuPzANm2TX1zLqvjZwKBgH5EsHKF6ahwK9Pe157VXUIxbKWCDMXseEhOdi5Z83xcT0XPZwqHbcEDx9LM53uGhyv3CGQbio0ChgrpS/R+H4jyTLlmV91XR4G+DWI5XZlAQZ+kaTAPY5pbnTu/SiErYbhvYFNh3tnEkIpUrjhAzK0am9b2EZDyWvENy0wRLYU5AoGANSdlM1zfY3VzoOOFrj/JQVJJZa/zNDJ/MM88ZkRz/knjEAOG/h1vzNf7hci1ntoBtZ+HmoY4V4U4eSHwi0c2/i2uHDbErIOpTxx0BFT6dNsubZcoeSSrOQYRric+3PbFlpIZwtkQbFIci2x6OD+DzV8RyfyD5R6EfNKQ/t9N4WE=";
            //String pb="MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAjQMPj2nr7ws+EXdFlmK/fasC5LLsIx4hUG2Q1hjFQtTSI1VKVLiuDSt79FqTRGmVcXIEjRqW+mZUf64ufrnc94EunVNUx0PAc7NTfBGqfuXsfho0b0DZtzAnL4eP6AXLt6UbSTPJ35v2VlkGOADDhuGpzoMdOJjAo9WD5vPqI3PyLjwOep5CSiG4tT01pTOjcbUaQHBdL2jIySigsGkMwl0i3oCHZLhJi+AX48gTp0jL3beecJ6r+FtjsnSzmM6xhhPZHJX2RnsLXhbdkNDkfiw0A0TptXTu7dnH5q0jR3k66hMM7AuNnjFdQ4EBrXldnA4rwRPRnj2GckG6oM7PfQIDAQAB";
            //wh00382下的公钥
            String pr ="MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCCaZTN0L8p9dFd9h2nabJpfQbeHj5ax00vWwhYs3fIzNthsA7Au8YRbhX271VNd+2652wFuzUWNqgXT7tv8xDPW/BQYpsasS4l6K3Tg6xIBWmS/GohseY8u5QHtviYQzTFAODWxuYyCYYcS1X26Wdc2zMGA5H9r6oKNJ5OVFAiq7XqxeicdSbDgZ3Dd7rrHl4CXswk2P9bowYkhxtkbuzpsc+UoYcmlMdUTIlOy+zLmcGesDY70OjY+YgMtR4FOu5wFirE8ajCwi1v+YPzJ0TvkrSELB8Ag8JarxfepX+cBuA55RP4jZti/UW3pmq+qAUFSmQJgsHECMc/JjN5uGy5AgMBAAECggEAT6hsMzdhvSCgrVMrE9p1Fwg+jKhOkCaS1+0z8PJWpXm0OzxOFp3bw0PJ+NaB9VrfBD5ddja+m33xOKQEKsJ+rxpKdN92PFyjgpZYrw0Ly8Y6kYTK0yAWMVymc/voZyEN95OswqQlccTtfRTrQnGZKFfgF7lQkHOfWrJ/S/smI7Z9KVvLn2yW0OIWfaxIbiNPFUh2XnUkUawzAeH4XGPBGp/blMS5jv+EOoBKYTdBM3dij4rtBvKk2K3EA2G/3PIInu4kynhwiQ0Gbo0yWzoKhvfICcsQThAmxp/b4SBRmZVpTr8GJILOmt6x7GvYpXMKTaP8BQs5SXFVPTSVv3vwXQKBgQDDLNYujblM7swjpH9GPmxPvSH72aeab3BY6VMR4EnRS1cIxpMnxYwkOSROXGc1XfMNyYYZzeEnqKHQrXGa8QN1zQ7WO2CnG1nJYUNdnzWEhN+OB5gnPOxJ35cRWaYVZMlHr7TreT04A6Wn0W2tdrmZfryxbQj55JDWvATqRdMQIwKBgQCrDfHyLDNnmyKKyBbC3tjdqG8ZoE7GROm/6SEhweubXRFd1svUfkV6Zsm7QPcb9Cxvefy8DPBJaFi1obj33gGtzI8+8Zsd8ukU5VtuIpj/E0v5AFwp/wzFAV93uYTZaDN0OkySdBDBuhrt3LhW2YQ5urw3qPHJvGtyFCoSsoNvcwKBgQCuDTID2gdBgEM0FeIadliI05WWzwcURgTehVS7QFUT/Cflf5CDizvqobqq1uSDRwEVbn3UTTFY+J01RzdkgUIgr3lnuxP6cf2kBMTanLxRLV1ff45Ej6P4TRifNF9T/Mky0JJ622eoqDf2bGFuq83gAJGteBrlHtu7Y3jOou4SGQKBgAYwO/eZ98Ygy7Afqwsjys7CIDraHN95cMd7pLI29NIrHMy7T6aBZvwVqei3YflF7TGfRTB8e1j8iHERx8JX6tGh2/DYBtefiSUzYwpqAAUCarY4eB0g2BJsiUqokJDY/zuOPGT0BAMuO3ktihHCTtFT2ylcWFsHERAQgLEqeizXAoGAL3JonWr33Fr4ui+BCY2z35MxmYt0ie05exbtgIFp6dQCojO0t6QWWZGQRGOEWOQr5TDOa+nJ85rhScztr37/b+XB1EXfl2DVy91NiMeWcLnVDmfTySWwBa+7uwgoQNCZgT1lH9bl8sgi0BFtUAY/4znse8cD7hoN6WTKbBaVEls=";
            String pb="MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAgmmUzdC/KfXRXfYdp2myaX0G3h4+WsdNL1sIWLN3yMzbYbAOwLvGEW4V9u9VTXftuudsBbs1FjaoF0+7b/MQz1vwUGKbGrEuJeit04OsSAVpkvxqIbHmPLuUB7b4mEM0xQDg1sbmMgmGHEtV9ulnXNszBgOR/a+qCjSeTlRQIqu16sXonHUmw4Gdw3e66x5eAl7MJNj/W6MGJIcbZG7s6bHPlKGHJpTHVEyJTsvsy5nBnrA2O9Do2PmIDLUeBTrucBYqxPGowsItb/mD8ydE75K0hCwfAIPCWq8X3qV/nAbgOeUT+I2bYv1Ft6ZqvqgFBUpkCYLBxAjHPyYzebhsuQIDAQAB";
            PrivateKey PrivateKeyStr =PKIUtil.getPrivateKey(pr);
            String sign = PKIUtil.encryptWithOwnPrk(stringDigestA,PrivateKeyStr);
            log.info("签名" + sign);
            //验证签名
            PublicKey publicKey  =PKIUtil.getPublicKey(pb);
            String ysign = PKIUtil.decryptWithMemberPuk(sign,publicKey);
            log.info("验证签名" + ysign);
            return sign;
        }catch (Exception e){
            e.printStackTrace();
        }
        return null;
    }

    //签名方法翻版
    public static String createSignT(SortedMap<String, String> map, MembersEntity member){
        //公私钥流
        /*String publicKeyBinary = String.valueOf(member.getZmemPublicKey());
        String PrivateKeyBinary = String.valueOf(member.getZmemPrivateKey());
        String publicKeyStr = SHA256Util.binaryToString(publicKeyBinary);
        String PrivateKeyStr = SHA256Util.binaryToString(PrivateKeyBinary);*/
        //String publicKeyBinary = "00000000010011010000000001001001000000000100100100000000010000100000000001001001000000000110101000000000010000010000000001001110000000000100001000000000011001110000000001101011000000000111000100000000011010000000000001101011000000000110100100000000010001110000000000111001000000000111011100000000001100000000000001000010000000000100000100000000010100010000000001000101000000000100011000000000010000010000000001000001000000000100111100000000010000110000000001000001000000000101000100000000001110000000000001000001000000000100110100000000010010010000000001001001000000000100001000000000010000110000000001100111000000000100101100000000010000110000000001000001000000000101000100000000010001010000000001000001000000000110110000000000011001010000000001110010000000000101100100000000011100010000000000110111000000000111011000000000011100110000000001101100000000000011000000000000001101100000000001100101000000000111001000000000010011100000000001100111000000000100101100000000001100010000000001110000000000000100111100000000010100100000000001010111000000000100110000000000011110100000000001110000000000000111011100000000010100000000000001001000000000000101010000000000011000110000000001001100000000000110001100000000010001110000000001010010000000000100011000000000011000100000000000101011000000000111101000000000011100100000000001101000000000000101000000000000010101100000000000101111000000000110101000000000001100000000000001010000000000000011100100000000011101100000000001000101000000000100100100000000010001000000000001000100000000000101000100000000010110010000000001101010000000000101010100000000011011100000000001101011000000000100011100000000011110100000000001101111000000000011000000000000011000110000000001100100000000000011000100000000011011110000000001110010000000000110110000000000011011010000000001001010000000000100100100000000001101010000000001110101000000000111001000000000011011100000000001101101000000000101001100000000001101110000000001110100000000000011011000000000010100010000000001100100000000000011001100000000010011110000000001111010000000000110010000000000011010100000000000110110000000000100001000000000001101000000000001101001000000000111010100000000010100110000000000110110000000000011100000000000011110010000000001101010000000000110101000000000011011110000000001101010000000000100010100000000011000010000000001011001000000000100011000000000001100000000000001000111000000000110100000000000001100000000000001010001000000000100101100000000011101000000000001010000000000000011001100000000001101100000000001001010000000000011000000000000010010010000000001111000000000000111010100000000010011100000000001011001000000000011010100000000010100100000000001101011000000000111100100000000011011110000000001000100000000000100111000000000001101010000000001010101000000000100100000000000011011110000000001000010000000000101010100000000010110010000000001001100000000000111011100000000010011100000000001110101000000000011001000000000011110010000000001000001000000000110100000000000011101000000000001010011000000000100100100000000010010110000000001111001000000000101011100000000010010000000000001001000000000000011010100000000011100010000000001110010000000000100110000000000001101100000000001000001000000000011001000000000001101000000000001100111000000000100011000000000010010010000000001001100000000000101001000000000011110010000000001101010000000000111010000000000011101010000000000110000000000000110111000000000010101110000000001000110000000000101100000000000011000010000000001001101000000000111101000000000010010110000000000111001000000000110000100000000010010010000000001000111000000000101001000000000010100100000000000110000000000000101000100000000010001100000000001010101000000000110011100000000010101000000000001101011000000000111100000000000001110000000000000101111000000000100111100000000011010100000000000110001000000000100010100000000010100010000000000110010000000000110010100000000001110000000000001111010000000000011011000000000001011110000000001001011000000000101011100000000001100100000000001100010000000000011000000000000011000100000000001001100000000000011001000000000011011010000000001100011000000000011011000000000010011100000000001111000000000000111100000000000010100110000000001101001000000000101011000000000010011010000000001101111000000000011001000000000010001100000000001011000000000000111000100000000001101100000000001110101000000000011000000000000010000100000000001000111000000000101010100000000010110100000000001110011000000000110111000000000011100010000000001011001000000000111001100000000010101100000000000110101000000000101010000000000011011110000000001110110000000000110110100000000011100000000000001110101000000000011010000000000011100000000000001100110000000000111000100000000001100100000000001000001000000000101101000000000001011110000000000110010000000000100111100000000011100000000000000111000000000000101000100000000011110000000000000110001000000000101011100000000011001100000000001000111000000000101001000000000011011010000000001111000000000000011011100000000011100100000000001100010000000000100100100000000010001100000000001101010000000000100101000000000010100100000000000101011000000000100110100000000011011000000000001100101000000000111100000000000001110010000000001001101000000000111010000000000011011110000000000101011000000000111100000000000010010010000000001101011000000000100100000000000001100000000000001001011000000000101101000000000010011000000000001001101000000000111001000000000011100000000000001001101000000000101000000000000001101010000000001010001000000000110100100000000011010110000000001110011000000000111000100000000010001000000000001000100000000000101101000000000011010010000000001100110000000000100111000000000010001000000000001000101000000000011011100000000011011000000000001101100000000000011100000000000011000110000000001011010000000000100010100000000011100100000000001111001000000000101011000000000011101100000000001010011000000000111101000000000011110100000000001111001000000000111011000000000001100000000000001101111000000000110110100000000011101100000000001110111000000000110110100000000010011000000000001110010000000000100110000000000010100100000000001010010000000000100010000000000010100010000000001110111000000000100100100000000010001000000000001000001000000000101000100000000010000010000000001000010";
        //String PrivateKeyBinary ="0000000001001101000000000100100100000000010010010000000001000101000000000111011000000000010000010000000001001001000000000100001000000000010000010000000001000100000000000100000100000000010011100000000001000010000000000110011100000000011010110000000001110001000000000110100000000000011010110000000001101001000000000100011100000000001110010000000001110111000000000011000000000000010000100000000001000001000000000101000100000000010001010000000001000110000000000100000100000000010000010000000001010011000000000100001100000000010000100000000001001011000000000101100100000000011101110000000001100111000000000110011100000000010100110000000001101001000000000100000100000000011001110000000001000101000000000100000100000000010000010000000001101111000000000100100100000000010000100000000001000001000000000101000100000000010000110000000001010110000000000011011000000000011101000000000001101001000000000111001000000000011101010000000000101011000000000111100100000000010110000000000001010100000000000111000000000000001101100000000001110011000000000011001000000000010000010000000001110010000000000101011100000000011010110000000000110101000000000100011000000000010110010000000001110110000000000100111100000000011011100000000001000001000000000011100000000000011001000000000001001110000000000111011100000000011101000000000001110111000000000101101000000000010001010000000001010110000000000111011000000000001101110000000001001111000000000111010100000000010001010000000000111001000000000101100000000000001010110000000001010000000000000101000100000000001011110000000000110010000000000011100000000000010100010000000001100111000000000100110100000000010011100000000001000010000000000110100100000000010011100000000001010011000000000110010100000000010100010000000001100010000000000100111100000000011010100000000001010010000000000111100000000000001100110000000001010111000000000110100100000000011101010000000001010111000000000101100100000000011010110000000001101010000000000110110100000000001101100000000001110101000000000110010100000000010110100000000001001100000000000111010100000000001100110000000001110000000000000100001000000000001100110000000001100011000000000011011100000000010011100000000000110010000000000101000000000000011011110000000001001000000000000110100100000000010010110000000000110101000000000100110000000000011100100000000001111010000000000100101100000000010011110000000001001111000000000110100100000000010011010000000001010010000000000111000000000000011001110000000001011000000000000101000100000000011000010000000001001000000000000101001000000000010000010000000001110001000000000011000000000000001011110000000001100110000000000110111100000000011011100000000001010001000000000110101000000000010001110000000000110100000000000011000100000000011010100000000001101100000000000100011100000000010101000000000001001011000000000110011100000000010011010000000000110011000000000110110000000000010100010000000001100101000000000110011100000000010001100000000001010010000000000110011100000000011101100000000001000001000000000011001000000000001101110000000001100010000000000100100100000000010000110000000001000111000000000011000100000000010010010000000001100111000000000111001000000000010010100000000001011001000000000110001100000000011001100000000001101101000000000111000100000000011100110000000001110110000000000110111100000000010001000000000001100010000000000110100100000000010000010000000001010101000000000110011100000000011101000000000001001000000000000100101100000000010011110000000000110010000000000011011100000000010100110000000001100100000000000101100100000000010101100000000001100100000000000110111100000000011110100000000001001101000000000111001000000000001100010000000001101111000000000110011100000000010110100000000001000110000000000100100000000000010100100000000001000001000000000101011000000000010100110000000001000010000000000100111100000000010101000000000001001000000000000111101000000000001110000000000000110110000000000101000000000000010101010000000001010010000000000100010000000000010110100000000000110111000000000111101000000000010100000000000001110010000000000011100000000000011100000000000001100010000000000101101000000000011101100000000001010010000000000111001100000000011101100000000001100001000000000101101000000000011110100000000001101111000000000011001100000000010010000000000001000110000000000100101100000000010010100000000001010101000000000111100100000000011010100000000001011001000000000101011000000000011001010000000001110010000000000111000100000000001101110000000001010001000000000100010100000000010110100000000001010010000000000110110100000000011110010000000001100101000000000111000000000000011010010000000001111000000000000101100000000000011011000000000001001111000000000110100100000000001010110000000001100001000000000110110100000000001101110000000001101001000000000110110000000000001010110000000001110010000000000101100100000000010000100000000001101110000000000010111100000000010110010000000000110110000000000110111000000000011110000000000001000100000000000100100000000000010101100000000001011010000000000011100000000000010110100000000001000111000000000110001000000000010010000000000001110101000000000111010000000000011100110000000001100111000000000101011100000000010011010000000001101100000000000100100000000000001101000000000001111001000000000101011000000000001101110000000001001000000000000011000000000000011110010000000000110010000000000110101000000000001101110000000001000101000000000110100100000000010100010000000001100110000000000101000100000000011100000000000001101011000000000111001100000000011110010000000001110101000000000110101100000000011101110000000000101111000000000110110000000000010000110000000001001011000000000101001100000000011110010000000001101111000000000100110100000000010011100000000001101101000000000100101000000000001110000000000000110000000000000100110100000000010101000000000001110101000000000101011100000000010110000000000001111000000000000111100000000000011010110000000001010011000000000111011000000000010010100000000001010111000000000011100100000000010011000000000001010000000000000101000000000000010010110000000000101111000000000101001100000000011010010000000001100001000000000010111100000000010000110000000001011001000000000111010100000000011100110000000001110100000000000100011000000000010001010000000001001110000000000100010000000000010000010000000001100111000000000100110100000000010000100000000001000001000000000100000100000000010001010000000001000011000000000110011100000000011001110000000001000101000000000100000100000000011000010000000001100010000000000111011000000000011001010000000000110100000000000101001000000000010000110000000001000100000000000110100000000000011110000000000001110101000000000111010100000000010001010000000001100100000000000011001000000000001100010000000001101100000000000111100100000000001100000000000001110111000000000011001100000000001110010000000001001101000000000111010000000000010101010000000001101001000000000101011100000000001110000000000001110001000000000100110100000000011110010000000001001110000000000100100100000000010100000000000001101110000000000111100100000000011000110000000001001100000000000011001100000000010100100000000001010011000000000100000100000000011110010000000001010000000000000111100000000000001110010000000001001001000000000111000000000000001010110000000000110000000000000100100100000000011110010000000001010110000000000110111000000000010001110000000001000011000000000011001000000000001011110000000001110110000000000101010100000000010010010000000001001110000000000100001000000000001101100000000001101001000000000101010000000000010000010000000001010110000000000110010100000000010001010000000001100010000000000011000000000000011010100000000001010010000000000011001000000000001100010000000001101111000000000110001000000000001110010000000001100010000000000101001100000000010011010000000001010010000000000101010000000000011011010000000001000110000000000111011000000000011110000000000001101111000000000111100100000000010000100000000000110000000000000101011100000000010011100000000001011010000000000101011000000000011100100000000001001010000000000111010100000000010011100000000001010111000000000011010100000000010100010000000001110110000000000011001100000000010010100000000001001101000000000100111100000000001101100000000001100111000000000101100000000000011010000000000000110011000000000101001100000000001010110000000001010101000000000100011000000000011110010000000001001001000000000101011000000000011001010000000001101011000000000011100100000000010100100000000001010001000000000011001000000000011001100000000001001011000000000110001100000000011010000000000001011000000000000011011000000000011010000000000001000010000000000100010000000000010001000000000001100100000000000111100000000000011011110000000001101000000000000011011000000000010000100000000001011010000000000011010000000000001100000000000001000001000000000011011000000000011100000000000001001111000000000100101100000000010011100000000000110100000000000110011000000000010100110000000001101100000000000100100000000000010010000000000001001001000000000011010100000000010011010000000001100110000000000011010000000000011100010000000001000110000000000100011100000000010110000000000001101001000000000110011000000000010110100000000001000100000000000110010000000000010001010000000000110100000000000100110100000000010011110000000001101010000000000110000100000000011100110000000000110010000000000011010000000000011101100000000001000100000000000111011100000000011100010000000001111010000000000101001100000000001101010000000001110010000000000101001100000000011100000000000000110001000000000101000100000000011001010000000001100010000000000100100000000000001101010000000000110100000000000100110000000000010110010000000001001010000000000111101000000000010001010000000001000011000000000100011100000000010100110000000001010000000000000100110100000000011101100000000001111000000000000100001000000000010101100000000000110110000000000110111000000000001110010000000001000011000000000110000100000000011001010000000001001011000000000110000100000000010000110000000001011001000000000011010000000000001101100000000001110001000000000011011000000000010110010000000001001000000000000011011000000000010010110000000001100101000000000110100100000000001101000000000000101111000000000111100000000000010010000000000000101011000000000110011000000000010101110000000001000111000000000100101100000000001011110000000001010010000000000110100100000000011011000000000001110000000000000100110000000000001101100000000001100011000000000100110000000000010001100000000001011010000000000110010100000000001100110000000000110001000000000100110000000000011101100000000001001010000000000011000000000000001100000000000000110011000000000110000100000000010101110000000001111000000000000100111000000000010011100000000001101001000000000111101000000000011001100000000001001100000000000100100100000000010110010000000001001000000000000101000000000000001100010000000001110100000000000101100100000000001110000000000000111001000000000111000000000000010010110000000001010111000000000011001100000000001100110000000001100111000000000101100000000000001100110000000001101110000000000110100000000000001110010000000000110000000000000110111000000000010011010000000000111000000000000100010100000000001011110000000001001000000000000111011100000000011010110000000001111001000000000101000000000000011000100000000001000111000000000110011000000000011101010000000001101011000000000110001000000000010100010000000001010101000000000110110000000000010000110000000001001111000000000110111000000000010000010000000000110001000000000110101100000000010100110000000001000100000000000100100000000000011001100000000001110010000000000010111100000000010011000000000000101011000000000011100100000000011011110000000001010110000000000101011000000000011001100000000000110101000000000011010000000000011100100000000000110110000000000101101000000000010000010000000000110001000000000101011000000000011110000000000000110001000000000100010000000000011100000000000001101111000000000101000100000000010010110000000001000010000000000110011100000000010100010000000001000100000000000100011100000000010011110000000000110110000000000110111100000000011100100000000001001011000000000101000100000000010101010000000001010111000000000101100100000000011011010000000001000101000000000100010100000000010010010000000000110010000000000101001100000000010010000000000001010000000000000100110000000000001100000000000001011001000000000100110000000000001100000000000001100001000000000111001100000000001100000000000001110010000000000011010100000000010110100000000001111001000000000011001000000000010011110000000001001001000000000110010000000000010000110000000001110010000000000100100000000000010010000000000000110110000000000111101000000000010101110000000001001000000000000110110000000000011000100000000001001101000000000110111000000000011100110000000000110000000000000100010000000000001101110000000000101111000000000111001000000000010000110000000001100101000000000110001000000000010001100000000001110011000000000011001100000000010011100000000001110110000000000111001000000000011000100000000001110100000000000011001000000000001100100000000001001001000000000110001000000000010110000000000001101001000000000110101000000000011101010000000001001110000000000100011000000000010101000000000000110111000000000110001000000000011000010000000001001110000000000100011000000000001100100000000001001011000000000100010100000000001101000000000001111010000000000101010000000000010100000000000001001100000000000110001100000000001110010000000001110011000000000110001100000000011000110000000000110110000000000110110100000000001100100000000001001000000000000011100000000000001100100000000001101111000000000110100000000000001100100000000001101010000000000111001100000000001110010000000001100101000000000111010000000000011000010000000001011000000000000111011100000000011010100000000001011000000000000011000000000000011010110000000000110100000000000101100100000000010101000000000001001100000000000011000100000000010100100000000001001001000000000111001000000000010101000000000001010101000000000100100000000000011100100000000001101111000000000011001100000000001011110000000000101011000000000111011100000000011010000000000001010101000000000110011000000000001110000000000000110101000000000100010100000000001100100000000001010110000000000100011000000000010001100000000001001110000000000111010000000000011110100000000001000100000000000101010100000000010010000000000001110111000000000110011100000000011001110000000001001110000000000100001000000000010001110000000000110111000000000100101100000000011101110000000001100101000000000100011100000000010011000000000000101011000000000101101000000000010000010000000001110100000000000010101100000000001110000000000001000110000000000101101000000000001110000000000001101001000000000110101100000000011101010000000001010001000000000100101100000000010000100000000001100111000000000101000100000000010001000000000001000010000000000110110100000000011100110000000001110100000000000110100000000000011010000000000001100001000000000101100000000000010010110000000001010010000000000100110000000000001100000000000001011000000000000011001100000000011001110000000001100111000000000011011100000000011010000000000001101110000000000100011000000000011100100000000000110111000000000011010100000000001110010000000001110100000000000011010000000000010000100000000000110101000000000110100000000000010000100000000001011000000000000101011100000000010011010000000001110000000000000011000100000000010011000000000001101110000000000100101000000000001101010000000001001101000000000100011000000000010001000000000001010111000000000111101000000000010110010000000001001010000000000100001100000000011101010000000001001100000000000100000100000000010001010000000000110100000000000101001100000000010000100000000001000100000000000100000100000000011101010000000001001010000000000010111100000000011000100000000001100101000000000011010100000000001100000000000001010011000000000011011100000000001100010000000001110110000000000111101000000000010100110000000001101001000000000110010100000000010100110000000001101000000000000101010000000000001101010000000001001010000000000101000100000000010010100000000001101001000000000110010000000000011110010000000001100011000000000100001000000000001110010000000001110110000000000110011000000000011100110000000001101101000000000110111100000000010011100000000001110011000000000111000100000000001101010000000001001001000000000111011000000000010000010000000001001111000000000011011000000000011101010000000001001000000000000111011000000000011100000000000001000011000000000011000000000000010101110000000000101111000000000100000100000000010001110000000001011001000000000011001100000000001110000000000001010001000000000011100000000000011010100000000000110001000000000111000100000000001100110000000001000101000000000110000100000000011011110000000001101110000000000100100000000000001101110000000001101010000000000110101000000000010000110000000000110100000000000110110000000000011001000000000001011000000000000011100100000000010011100000000001000011000000000111010100000000010101010000000001110000000000000010101100000000011100010000000000110001000000000111011100000000011100100000000001000010000000000110001100000000010001100000000001001011000000000101100000000000011100100000000001110011000000000111101000000000010000010000000000110011000000000100111100000000010100110000000000110000000000000111000000000000010010010000000001000001000000000111100000000000010001110000000001110011000000000101011000000000001101010000000001101000000000000100010000000000001110010000000000101111000000000110011100000000001010110000000001101000000000000011001000000000011101110000000001001011000000000100001000000000011001110000000001000100000000000011001100000000010011110000000001111001000000000100101100000000010110010000000001100111000000000110000100000000011010000000000001100101000000000111000100000000011011110000000001010000000000000110101100000000001101110000000001010110000000000011100100000000010011000000000001100001000000000011001000000000001100010000000001001011000000000011010100000000010001110000000001110100000000000011010000000000011110100000000000110111000000000011001000000000011011100000000001110011000000000100000100000000011100010000000001001011000000000010111100000000010010100000000001100010000000000011100100000000011010110000000001011000000000000111010100000000001100010000000000111000000000000100011000000000010001000000000001000010000000000100010100000000011100010000000000110000000000000100111100000000001101010000000001000010000000000101100100000000010100110000000001111000000000000110101100000000010011110000000001001011000000000101001100000000011010110000000001101110000000000110010000000000001101110000000000110011000000000010101100000000010001010000000001111010000000000011011100000000010110100000000001010001000000000111011100000000010110000000000001010011000000000110100000000000001100010000000001010100000000000100011000000000011101110000000001001001000000000111100100000000001110000000000001101101000000000100110000000000011001110000000001110110000000000100110100000000011110010000000001000101000000000101001100000000011010000000000001001010000000000101010100000000010000010000000001100011000000000111101000000000001011110000000000110011000000000011100100000000011100000000000001010111000000000010111100000000011000110000000001110010000000000101011100000000001011110000000001101010000000000011010100000000011110000000000001101010000000000011001000000000010101010000000001110111000000000100001000000000011100000000000001001010000000000111011000000000011100100000000001000001000000000101100000000000010100100000000001010101000000000111101000000000001011110000000001000100000000000011011100000000011010010000000000110111000000000100001000000000001010110000000001001111000000000101010100000000001011110000000001000011000000000101010100000000001100000000000001001111000000000110110100000000011010010000000001101111000000000100110000000000010110100000000001101100000000000010111100000000011100100000000001110100000000000110011000000000010101010000000001110110000000000101001100000000010010000000000001100100000000000101011100000000011011000000000001001000000000000111101000000000011001100000000001110001000000000111001100000000010101110000000001001101000000000100010100000000010010110000000001110000000000000110110000000000011101100000000001110011000000000110110100000000011001010000000001110101000000000110001000000000011110000000000001000001000000000110111100000000010001110000000001000001000000000101100000000000011010010000000001001001000000000110010100000000011010010000000001111010000000000011100100000000010010100000000001001111000000000110011100000000011110010000000001110011000000000100001100000000010001010000000001010000000000000100110000000000011100010000000001110101000000000011001000000000010101110000000001101010000000000110101100000000001100100000000001001000000000000100110000000000011001110000000001111000000000000101000000000000011011010000000001010001000000000111001000000000011011100000000001100101000000000110001100000000011010110000000001001110000000000110010000000000010100100000000001101010000000000011001100000000001100000000000001100110000000000110011100000000010100110000000001000111000000000101001000000000010001110000000001010110000000000100100000000000011011000000000001001111000000000011011000000000011011110000000001100101000000000101100000000000011100000000000001100001000000000111101000000000011001100000000001000010000000000101000000000000001010110000000001011001000000000110011100000000011101000000000001000110000000000110011100000000001100100000000001110101000000000011000000000000010011110000000001010011000000000111000000000000001101100000000001000001000000000110100000000000001100100000000001110100000000000110100100000000010000110000000001010011000000000011010100000000010001010000000001100001000000000111000000000000001110000000000001001010000000000011000000000000001100100000000001000110000000000101100100000000011110100000000001110111000000000101010100000000011100010000000001110011000000000110011100000000010000010000000001010010000000000101001100000000011000110000000001001001000000000111010000000000010110100000000000110101000000000101001000000000011001110000000001001001000000000111100100000000011100110000000001010100000000000110000100000000010001000000000001000100000000000111011100000000010001000000000001100100000000000110111100000000011011010000000001100110000000000100111100000000011100110000000001000011000000000110011100000000011110010000000000110111000000000111011100000000011000100000000001010001000000000101000100000000011110000000000001001100000000000110101100000000011101010000000001000011000000000011001000000000011110010000000001001110000000000110111100000000010101110000000001111001000000000101011000000000010000100000000001010111000000000100001100000000010000010000000001110111000000000100001000000000010110100000000001111001000000000011100100000000011010000000000001100010000000000101011000000000011110100000000000110010000000000011010000000000011011010000000001110001000000000110010100000000010100110000000001110000000000000111000000000000001011110000000001011000000000000110111100000000001010110000000000101011000000000100011100000000010000010000000001110011000000000100001100000000011001110000000001011001000000000100000100000000010110010000000001111000000000000110110100000000011010100000000001111000000000000100100000000000011100000000000001101011000000000101011100000000010010110000000000110100000000000011000000000000010010000000000001010100000000000111010100000000010101100000000001001001000000000100110100000000011001000000000001110010000000000100100100000000011101000000000001001000000000000101010000000000011001010000000001111001000000000111100000000000001101110000000001000010000000000111101000000000010010110000000001000111000000000111100000000000010001000000000000110010000000000111101000000000011100000000000001111010000000000100110100000000001010110000000001001000000000000100000100000000001101110000000001101111000000000111001100000000010011010000000001100001000000000100000100000000011100010000000001100011000000000101001000000000001101100000000000101011000000000110001100000000010001100000000001001000000000000110111000000000011001100000000001110100000000000011100000000000010010110000000001110101000000000111010000000000011000110000000001010111000000000011100100000000011001100000000001100011000000000110101000000000011011110000000001101111000000000110010000000000010100100000000001100001000000000111101000000000001101000000000000111000000000000110101000000000011010000000000001010000000000000111000100000000010010110000000001000100000000000111010000000000001011110000000001000111000000000100000100000000011001110000000001100101000000000110111100000000010010100000000001110100000000000011010000000000011100010000000000111000000000000110011100000000011100010000000001010011000000000011000100000000010100110000000001010010000000000010111100000000001011110000000001010110000000000110110100000000010011010000000001001010000000000101000100000000001010110000000000110101000000000101000100000000011010110000000001101000000000000111100100000000010110000000000001011000000000000100000100000000001101100000000001001000000000000011011000000000010011100000000001001101000000000110011100000000010110010000000001000101000000000101001100000000010101100000000001101010000000000110110000000000001101100000000001001101000000000111001000000000011010000000000000101111000000000110001100000000010011010000000000110011000000000111010000000000010110010000000001100100000000000110000100000000011010000000000001000001000000000111101000000000011011110000000001001001000000000100100000000000001100010000000001000010000000000100010000000000001010110000000001000101000000000110001100000000001011110000000001101110000000000110111100000000010101010000000001001010000000000100111000000000010011000000000001001111000000000100110100000000010011000000000001011001000000000111010100000000010110100000000001111000000000000101011100000000011110010000000000110000000000000100000100000000001111010000000000111101";
        //公私钥字符串
        String publicKeyStr =member.getZmemPublicKey();
        String PrivateKeyStr =member.getZmemPrivateKey();
        //数字签名
        try{
            //按照参数名ASCII码从小到大排序拼接成字符串stringA。
            String stringA= SignatureUtil.genOrderedString(map);
            //对stringA使用SHA256算法运算作为数字摘要stringDigest
            String stringDigestA = DigestUtils.sha256Hex(stringA);
            log.info("签名前的stringDigestA数字摘要值：" + stringDigestA);
            //生成签名
            PrivateKey privateKey =PKIUtil.getPrivateKey(PrivateKeyStr);
            String sign = PKIUtil.encryptWithOwnPrk(stringDigestA,privateKey);
            log.info("签名" + sign);
            //验证签名
            PublicKey publicKey  =PKIUtil.getPublicKey(publicKeyStr);
            String ysign = PKIUtil.decryptWithMemberPuk(sign,publicKey);
            log.info("验证签名" + ysign);
            return sign;
        }catch (Exception e){
            e.printStackTrace();
        }
        return null;
    }

}
